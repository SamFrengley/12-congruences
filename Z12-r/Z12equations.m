/*
    Functions are:

    Z12Equations(r, u, v)
        The equations for Z(12, r). This function 
        returns an f such that an equaton for Z(12, r) is given as a double cover 
        of the u,v plane of the form w^2 - f(u,v) = 0.               

    W12Moduli(r, u,v)
        Returns a pair j*j', (j - 1728)*(j' - 1728) giving the moduli 
        interpretation of W(12, r) = Z(12, r)/i which is indentified with the (u,v) plane.               
        
*/

function Z12Equations(r, u, v)
    // The equations for Z(12, r). This function 
    // returns an f such that an equaton for Z(12, r) is given as a double cover 
    // of the u,v plane of the form w^2 - f(u,v) = 0.
    if (r mod 12) eq 1 then
        f := -4*u^4 + (-4*v^2 - 6)*u^3 + (-v^4 + 13*v^2 - 3)*u^2 + (10*v^4 + 18*v^2)*u + v^6 - 6*v^4 + 9*v^2;

    elif (r mod 12) eq 5 then
        f := v^2*u^8 + 4*v^2*u^7 + (-4*v^4 - 20*v^2 + 4)*u^6 + (-12*v^4 - 32*v^2 - 8)*u^5 + (6*v^6 + 44*v^4 + 160*v^2 - 76)*u^4 + 
            (12*v^6 + 64*v^4 - 64*v^2 + 352)*u^3 + (-4*v^8 - 28*v^6 - 204*v^4 - 232*v^2 - 592)*u^2 + (-4*v^8 - 32*v^6 + 72*v^4 + 
            224*v^2 + 448)*u + v^10 + 4*v^8 + 40*v^6 + 52*v^4 - 32*v^2 - 128;

    elif (r mod 12) eq 7 then
        f := (-v^2 - 1)*u^6 + (-6*v^2 - 4)*u^5 + (2*v^4 - 9*v^2 - 1)*u^4 + (6*v^4 + 10)*u^3 + (-v^6 - 2*v^4 + 3*v^2 + 4)*u^2 + (-4*v^4 
            + 12*v^2 - 8)*u + v^6 - 2*v^4 + v^2;

    elif (r mod 12) eq 11 then
        f := (-v^8 - 6*v^6 - v^4)*u^6 + (-2*v^8 - 52*v^6 - 10*v^4)*u^5 + (9*v^10 + 85*v^8 - 176*v^6 - 107*v^4 - 11*v^2)*u^4 + (596*v^8 
            + 280*v^6 - 28*v^4 - 16*v^2)*u^3 + (-27*v^12 - 576*v^10 - 48*v^8 + 270*v^6 + 92*v^4 + 8*v^2 + 1)*u^2 + (162*v^12 - 
            324*v^10 - 468*v^8 - 156*v^6 + 4*v^4 + 12*v^2 + 2)*u + 189*v^12 + 243*v^10 + 90*v^8 - 16*v^6 - 18*v^4 - v^2 + 1;
    end if;

    return f;
end function;


function W12Moduli(r, u,v)
    // Returns a pair (j*j', (j - 1728)*(j' - 1728)) giving the moduli 
    // interpretation of W(12, r) = Z(12, r)/i the (u,v) plane.
    assert (r mod 12) in [1,5,7,11];

    if (r mod 12) eq 1 then
        jj := 2985984*(u^10 - 1/3*u^9*v^2 + 16*u^9 - 47/36*u^8*v^4 + 52/3*u^8*v^2 + 108*u^8 - 
            1/9*u^7*v^6 + 39*u^7*v^4 + 479/3*u^7*v^2 + 409*u^7 + 1/2*u^6*v^8 + 
            857/18*u^6*v^6 + 555/2*u^6*v^4 + 1147/2*u^6*v^2 + 976*u^6 + 2/9*u^5*v^10 + 
            197/9*u^5*v^8 + 146*u^5*v^6 + 684*u^5*v^4 + 1108*u^5*v^2 + 1551*u^5 + 
            1/36*u^4*v^12 + 8/3*u^4*v^10 - 1817/36*u^4*v^8 - 346/3*u^4*v^6 + 3031/4*u^4*v^4 
            + 1266*u^4*v^2 + 6705/4*u^4 - 4/9*u^3*v^12 - 496/9*u^3*v^10 - 1232/3*u^3*v^8 - 
            2672/3*u^3*v^6 + 300*u^3*v^4 + 864*u^3*v^2 + 1224*u^3 - 1/18*u^2*v^14 - 
            59/6*u^2*v^12 - 189/2*u^2*v^10 - 1157/2*u^2*v^8 - 2523/2*u^2*v^6 - 219/2*u^2*v^4
            + 657/2*u^2*v^2 + 1161/2*u^2 + 2/9*u*v^14 + 82/3*u*v^12 + 82*u*v^10 - 234*u*v^8 
            - 762*u*v^6 - 126*u*v^4 + 54*u*v^2 + 162*u + 1/36*v^16 + 20/3*v^14 + 179/3*v^12 
            + 120*v^10 + 15/2*v^8 - 180*v^6 - 27*v^4 + 81/4)^(3)/((u)^(12)*(u - v + 
            1)^(2)*(u + v + 1)^(2)*(u + v^2 + 1)^(8)*(u + 1/2*v^2 + 3/2)^(6));

        jj_1728 := 107495424*(u^14*v^2 + 9/4*u^14 + 22/9*u^13*v^4 + 97/4*u^13*v^2 + 279/8*u^13 + 
            431/162*u^12*v^6 + 5729/144*u^12*v^4 + 3531/16*u^12*v^2 + 4059/16*u^12 + 
            95/54*u^11*v^8 + 383/18*u^11*v^6 + 8023/36*u^11*v^4 + 2267/2*u^11*v^2 + 
            4581/4*u^11 + 347/432*u^10*v^10 - 697/108*u^10*v^8 - 6319/144*u^10*v^6 + 
            28453/48*u^10*v^4 + 30641/8*u^10*v^2 + 57249/16*u^10 + 85/324*u^9*v^12 - 
            547/36*u^9*v^10 - 7159/36*u^9*v^8 - 24541/36*u^9*v^6 + 1309/2*u^9*v^4 + 
            9168*u^9*v^2 + 8172*u^9 + 13/216*u^8*v^14 - 215/24*u^8*v^12 - 12377/108*u^8*v^10
            - 28501/48*u^8*v^8 - 47699/24*u^8*v^6 - 1145/2*u^8*v^4 + 32283/2*u^8*v^2 + 
            224865/16*u^8 + 1/108*u^7*v^16 - 277/108*u^7*v^14 - 79/36*u^7*v^12 + 
            8813/36*u^7*v^10 + 25055/36*u^7*v^8 - 18455/12*u^7*v^6 - 13029/4*u^7*v^4 + 
            84999/4*u^7*v^2 + 36945/2*u^7 + 1/1296*u^6*v^18 - 13/36*u^6*v^16 + 
            505/24*u^6*v^14 + 276601/648*u^6*v^12 + 47033/18*u^6*v^10 + 163291/24*u^6*v^8 + 
            101399/24*u^6*v^6 - 46917/8*u^6*v^4 + 335079/16*u^6*v^2 + 149085/8*u^6 - 
            1/36*u^5*v^18 + 1649/216*u^5*v^16 + 7753/54*u^5*v^14 + 10391/9*u^5*v^12 + 
            54601/9*u^5*v^10 + 186737/12*u^5*v^8 + 27037/2*u^5*v^6 - 6540*u^5*v^4 + 
            61029/4*u^5*v^2 + 114831/8*u^5 - 1/432*u^4*v^20 + 131/144*u^4*v^18 - 
            1193/432*u^4*v^16 - 6041/36*u^4*v^14 + 5069/72*u^4*v^12 + 137519/24*u^4*v^10 + 
            148713/8*u^4*v^8 + 74115/4*u^4*v^6 - 81207/16*u^4*v^4 + 127683/16*u^4*v^2 + 
            132921/16*u^4 + 1/36*u^3*v^20 - 685/81*u^3*v^18 - 2293/12*u^3*v^16 - 
            11204/9*u^3*v^14 - 5935/2*u^3*v^12 + 946*u^3*v^10 + 25605/2*u^3*v^8 + 
            15036*u^3*v^6 - 11259/4*u^3*v^4 + 2835*u^3*v^2 + 14013/4*u^3 + 1/432*u^2*v^22 - 
            431/432*u^2*v^20 - 3371/144*u^2*v^18 - 31387/144*u^2*v^16 - 34819/24*u^2*v^14 - 
            31441/8*u^2*v^12 - 18723/8*u^2*v^10 + 39213/8*u^2*v^8 + 120447/16*u^2*v^6 - 
            17361/16*u^2*v^4 + 9801/16*u^2*v^2 + 16281/16*u^2 - 1/108*u*v^22 + 37/12*u*v^20 
            + 2183/36*u*v^18 + 2183/12*u*v^16 - 759/2*u*v^14 - 3957/2*u*v^12 - 3465/2*u*v^10
            + 1701/2*u*v^8 + 8721/4*u*v^6 - 1053/4*u*v^4 + 243/4*u*v^2 + 729/4*u - 
            1/1296*v^24 + 7/18*v^22 + 925/72*v^20 + 266/3*v^18 + 3701/16*v^16 + 105*v^14 - 
            1401/4*v^12 - 378*v^10 + 297/16*v^8 + 567/2*v^6 - 243/8*v^4 + 
            243/16)^(2)/((u)^(12)*(u - v + 1)^(2)*(u + v + 1)^(2)*(u + v^2 + 1)^(8)*(u + 
            1/2*v^2 + 3/2)^(6));

    elif (r mod 12) eq 5 then
        jj := 1*(u^16 - 8*u^15 - 8*u^14*v^2 + 56*u^13*v^2 + 192*u^13 + 28*u^12*v^4 + 
            240*u^12*v^2 - 672*u^12 - 168*u^11*v^4 - 2912*u^11*v^2 + 96*u^11 - 56*u^10*v^6 -
            1440*u^10*v^4 + 6176*u^10*v^2 + 4448*u^10 + 280*u^9*v^6 + 11680*u^9*v^4 + 
            13344*u^9*v^2 - 12928*u^9 + 70*u^8*v^8 + 3600*u^8*v^6 - 16320*u^8*v^4 - 
            72576*u^8*v^2 + 26496*u^8 - 280*u^7*v^8 - 21440*u^7*v^6 - 58944*u^7*v^4 + 
            79488*u^7*v^2 - 65536*u^7 - 56*u^6*v^10 - 4800*u^6*v^8 + 16960*u^6*v^6 + 
            197952*u^6*v^4 + 66816*u^6*v^2 + 144128*u^6 + 168*u^5*v^10 + 20480*u^5*v^8 + 
            95808*u^5*v^6 - 110208*u^5*v^4 - 130048*u^5*v^2 - 216576*u^5 + 28*u^4*v^12 + 
            3600*u^4*v^10 - 4640*u^4*v^8 - 200576*u^4*v^6 - 258816*u^4*v^4 - 195584*u^4*v^2 
            + 260352*u^4 - 56*u^3*v^12 - 9952*u^3*v^10 - 68640*u^3*v^8 + 33664*u^3*v^6 + 
            313856*u^3*v^4 + 551424*u^3*v^2 - 350208*u^3 - 8*u^2*v^14 - 1440*u^2*v^12 - 
            3168*u^2*v^10 + 75360*u^2*v^8 + 192768*u^2*v^6 + 97536*u^2*v^4 - 424960*u^2*v^2 
            + 436224*u^2 + 8*u*v^14 + 1952*u*v^12 + 18336*u*v^10 + 9984*u*v^8 - 118272*u*v^6
            - 279552*u*v^4 + 96256*u*v^2 - 327680*u + v^16 + 240*v^14 + 1664*v^12 - 
            4608*v^10 - 27264*v^8 - 9216*v^6 + 103424*v^4 + 12288*v^2 + 102400)^(3)/((u - 
            1)^(12)*(u - v - 2)^(6)*(u + v - 2)^(6)*(u^2 - v^2 - 4)^(6));
        
        jj_1728 := 1*(u^24 - 12*u^23 - 12*u^22*v^2 + 24*u^22 + 132*u^21*v^2 + 320*u^21 + 
            66*u^20*v^4 - 744*u^20*v^2 - 2064*u^20 - 660*u^19*v^4 + 3120*u^19*v^2 + 
            2256*u^19 - 220*u^18*v^6 + 6120*u^18*v^4 - 2256*u^18*v^2 + 18832*u^18 + 
            1980*u^17*v^6 - 42480*u^17*v^4 - 76944*u^17*v^2 - 62208*u^17 + 495*u^16*v^8 - 
            25560*u^16*v^6 + 76704*u^16*v^4 + 448416*u^16*v^2 - 92160*u^16 - 3960*u^15*v^8 +
            189120*u^15*v^6 + 681024*u^15*v^4 - 841344*u^15*v^2 + 951808*u^15 - 
            792*u^14*v^10 + 65520*u^14*v^8 - 284736*u^14*v^6 - 4033920*u^14*v^4 - 
            918912*u^14*v^2 - 1943616*u^14 + 5544*u^13*v^10 - 463680*u^13*v^8 - 
            2802240*u^13*v^6 + 5945088*u^13*v^4 + 5994240*u^13*v^2 - 1133184*u^13 + 
            924*u^12*v^12 - 111888*u^12*v^10 + 468384*u^12*v^8 + 13685248*u^12*v^6 + 
            13011264*u^12*v^4 - 4710528*u^12*v^2 + 11636288*u^12 - 5544*u^11*v^12 + 
            715680*u^11*v^10 + 6536544*u^11*v^8 - 13862016*u^11*v^6 - 54126336*u^11*v^4 - 
            15759360*u^11*v^2 - 10258176*u^11 - 792*u^10*v^14 + 132048*u^10*v^12 - 
            321888*u^10*v^10 - 24883296*u^10*v^8 - 48837120*u^10*v^6 + 31359552*u^10*v^4 + 
            37143168*u^10*v^2 - 61796352*u^10 + 3960*u^9*v^14 - 729120*u^9*v^12 - 
            9383136*u^9*v^10 + 13935360*u^9*v^8 + 138861568*u^9*v^6 + 135623040*u^9*v^4 - 
            48417024*u^9*v^2 + 248341504*u^9 + 495*u^8*v^16 - 108720*u^8*v^14 - 
            102144*u^8*v^12 + 26563008*u^8*v^10 + 87215040*u^8*v^8 - 32041728*u^8*v^6 - 
            269146944*u^8*v^4 + 175319040*u^8*v^2 - 453012480*u^8 - 1980*u^7*v^16 + 
            492480*u^7*v^14 + 8495424*u^7*v^12 - 3092352*u^7*v^10 - 167380992*u^7*v^8 - 
            321647616*u^7*v^6 + 118783488*u^7*v^4 - 557826048*u^7*v^2 + 433336320*u^7 - 
            220*u^6*v^18 + 61560*u^6*v^16 + 367296*u^6*v^14 - 16630016*u^6*v^12 - 
            83391360*u^6*v^10 - 17551296*u^6*v^8 + 439576320*u^6*v^6 + 44427264*u^6*v^4 + 
            900759552*u^6*v^2 - 76255232*u^6 + 660*u^5*v^18 - 213120*u^5*v^16 - 
            4747584*u^5*v^14 - 5481216*u^5*v^12 + 100335360*u^5*v^10 + 325795968*u^5*v^8 - 
            32497152*u^5*v^6 + 255387648*u^5*v^4 - 578531328*u^5*v^2 - 342589440*u^5 + 
            66*u^4*v^20 - 22920*u^4*v^18 - 290064*u^4*v^16 + 5544960*u^4*v^14 + 
            41963712*u^4*v^12 + 42782592*u^4*v^10 - 280678464*u^4*v^8 - 297879552*u^4*v^6 - 
            692041728*u^4*v^4 - 396632064*u^4*v^2 + 418578432*u^4 - 132*u^3*v^20 + 
            53680*u^3*v^18 + 1500240*u^3*v^16 + 4524672*u^3*v^14 - 25970432*u^3*v^12 - 
            143545344*u^3*v^10 - 46397184*u^3*v^8 + 94687232*u^3*v^6 + 585768960*u^3*v^4 + 
            1116438528*u^3*v^2 - 153223168*u^3 - 12*u^2*v^22 + 5064*u^2*v^20 + 
            106416*u^2*v^18 - 666288*u^2*v^16 - 9325824*u^2*v^14 - 19673664*u^2*v^12 + 
            63682176*u^2*v^10 + 152463360*u^2*v^8 + 162607104*u^2*v^6 - 129613824*u^2*v^4 - 
            980779008*u^2*v^2 - 80412672*u^2 + 12*u*v^22 - 6000*u*v^20 - 205584*u*v^18 - 
            1065984*u*v^16 + 1334784*u*v^14 + 20666496*u*v^12 + 18786048*u*v^10 - 
            40590336*u*v^8 - 117202944*u*v^6 - 78643200*u*v^4 + 425066496*u*v^2 + 93585408*u
            + v^24 - 504*v^22 - 15648*v^20 - 46944*v^18 + 375360*v^16 + 1778688*v^14 - 
            2212544*v^12 - 12533760*v^10 - 8555520*v^8 + 17104896*v^6 + 36618240*v^4 - 
            76677120*v^2 - 25690112)^(2)/((u - 1)^(12)*(u - v - 2)^(6)*(u + v - 2)^(6)*(u^2 
            - v^2 - 4)^(6));

    elif (r mod 12) eq 7 then
        jj := 16777216*(u - v - 1)^(2)*(u + v - 1)^(2)*(u^8*v^4 + 1/2*u^8*v^2 + 1/16*u^8 + 
            4*u^7*v^4 + u^7*v^2 - 2*u^6*v^6 + 5/2*u^6*v^4 - 17/2*u^6*v^2 - 3/8*u^6 - 
            4*u^5*v^6 - 2*u^5*v^4 - 2*u^5*v^2 + 1/4*u^5 + u^4*v^8 + 3/2*u^4*v^6 + 
            335/8*u^4*v^4 + 237/8*u^4*v^2 + 9/16*u^4 + u^3*v^6 - 2*u^3*v^4 - 55/2*u^3*v^2 - 
            3/4*u^3 - 1/2*u^2*v^8 - 13/2*u^2*v^6 - 1/8*u^2*v^4 + 57/8*u^2*v^2 + 1/4*u^2 + 
            1/4*u*v^4 - 1/4*u*v^2 + 1/16*v^8 - 1/8*v^6 + 1/16*v^4)^(3)/((v)^(4)*(u)^(4)*(u^2
            + v^2 - 1)^(12));

        jj_1728 := 16777216*(u^14*v^6 + 3/4*u^14*v^4 - 15/64*u^14*v^2 + 1/64*u^14 + 4*u^13*v^6 + 
            3/2*u^13*v^4 - 1/32*u^13 - 4*u^12*v^8 - 11/4*u^12*v^6 + 387/32*u^12*v^4 + 
            371/64*u^12*v^2 - 1/8*u^12 - 12*u^11*v^8 - 16*u^11*v^6 - 6*u^11*v^4 - 
            141/16*u^11*v^2 + 3/8*u^11 + 6*u^10*v^10 + 9/2*u^10*v^8 - 7489/64*u^10*v^6 - 
            8649/64*u^10*v^4 - 1827/64*u^10*v^2 + 3/32*u^10 + 12*u^9*v^10 + 13*u^9*v^8 + 
            14*u^9*v^6 + 5169/32*u^9*v^4 + 663/8*u^9*v^2 - 21/16*u^9 - 4*u^8*v^12 - 
            9/2*u^8*v^10 + 3573/16*u^8*v^8 + 30625/64*u^8*v^6 + 2775/8*u^8*v^4 - 
            837/32*u^8*v^2 + 21/16*u^8 - 4*u^7*v^12 + 6*u^7*v^8 - 3547/8*u^7*v^6 - 
            7863/8*u^7*v^4 - 1197/8*u^7*v^2 + 3/4*u^7 + u^6*v^14 + 11/4*u^6*v^12 - 
            8001/64*u^6*v^10 - 7705/64*u^6*v^8 - 4273/32*u^6*v^6 + 7851/8*u^6*v^4 + 
            15819/64*u^6*v^2 - 159/64*u^6 + 3/2*u^5*v^12 - 6*u^5*v^10 + 5169/32*u^5*v^8 + 
            3453/8*u^5*v^6 - 3837/8*u^5*v^4 - 1401/8*u^5*v^2 + 67/32*u^5 - 3/4*u^4*v^14 + 
            579/32*u^4*v^12 + 1101/64*u^4*v^10 + 765/16*u^4*v^8 - 1005/4*u^4*v^6 + 
            3447/32*u^4*v^4 + 3951/64*u^4*v^2 - 13/16*u^4 - 141/16*u^3*v^10 - 12*u^3*v^8 + 
            327/8*u^3*v^6 - 87/8*u^3*v^4 - 149/16*u^3*v^2 + 1/8*u^3 - 15/64*u^2*v^14 - 
            191/64*u^2*v^12 + 429/64*u^2*v^10 - 15/32*u^2*v^8 - 373/64*u^2*v^6 + 
            165/64*u^2*v^4 + 15/64*u^2*v^2 - 1/32*u*v^12 + 3/16*u*v^8 - 1/4*u*v^6 + 
            3/32*u*v^4 - 1/64*v^14 + 1/16*v^12 - 3/32*v^10 + 1/16*v^8 - 
            1/64*v^6)^(2)/((v)^(4)*(u)^(4)*(u^2 + v^2 - 1)^(12));

    elif (r mod 12) eq 11 then
        jj := 2985984*(u^4*v^12 + 4*u^4*v^10 + 310/9*u^4*v^8 + 4*u^4*v^6 + u^4*v^4 + 
            20*u^3*v^12 - 16/3*u^3*v^10 + 1592/9*u^3*v^8 + 976/9*u^3*v^6 + 20*u^3*v^4 - 
            18*u^2*v^14 + 90*u^2*v^12 + 34*u^2*v^10 + 980/3*u^2*v^8 + 974/3*u^2*v^6 + 
            302/3*u^2*v^4 + 6*u^2*v^2 - 180*u*v^14 - 388*u*v^12 - 620*u*v^10 - 2392/9*u*v^8 
            + 364/3*u*v^6 + 308/3*u*v^4 + 124/9*u*v^2 + 81*v^16 + 198*v^14 + 169*v^12 - 
            398/3*v^10 - 2180/9*v^8 - 706/9*v^6 + 43/3*v^4 + 62/9*v^2 + 
            1/9)^(3)/((v)^(12)*(v^2 + 1)^(12)*(u - 1)^(12));

        jj_1728 := 1719926784*(u^6*v^16 + 4*u^6*v^14 - 26/81*u^6*v^12 + 4*u^6*v^10 + u^6*v^8 - 
            3/2*u^5*v^18 + 13/3*u^5*v^16 + 1103/18*u^5*v^14 + 1054/27*u^5*v^12 + 
            1801/54*u^5*v^10 + 37/3*u^5*v^8 + 1/2*u^5*v^6 + 9/8*u^4*v^20 - 18*u^4*v^18 - 
            254/3*u^4*v^16 + 1429/9*u^4*v^14 + 29927/108*u^4*v^12 + 6128/27*u^4*v^10 + 
            2477/27*u^4*v^8 + 13*u^4*v^6 + 5/8*u^4*v^4 + 45/2*u^3*v^20 + 3*u^3*v^18 - 
            1406/3*u^3*v^16 - 3923/9*u^3*v^14 + 5749/81*u^3*v^12 + 10127/27*u^3*v^10 + 
            6574/27*u^3*v^8 + 4619/81*u^3*v^6 + 9/2*u^3*v^4 - 81/8*u^2*v^22 + 189/2*u^2*v^20
            + 3963/8*u^2*v^18 + 410/3*u^2*v^16 - 21889/36*u^2*v^14 - 16216/27*u^2*v^12 - 
            4691/108*u^2*v^10 + 1580/9*u^2*v^8 + 16721/216*u^2*v^6 + 565/54*u^2*v^4 + 
            5/24*u^2*v^2 - 405/4*u*v^22 - 342*u*v^20 - 711/4*u*v^18 + 119/3*u*v^16 - 
            2419/9*u*v^14 - 15104/27*u*v^12 - 8855/27*u*v^10 - 797/27*u*v^8 + 3275/108*u*v^6
            + 224/27*u*v^4 + 41/108*u*v^2 + 243/8*v^24 + 891/8*v^22 + 1305/8*v^20 + 
            2127/8*v^18 + 9811/24*v^16 + 11975/36*v^14 + 23557/324*v^12 - 6263/108*v^10 - 
            6905/216*v^8 - 601/648*v^6 + 391/216*v^4 + 41/216*v^2 - 
            1/648)^(2)/((v)^(12)*(v^2 + 1)^(12)*(u - 1)^(12))
            ;
    end if;
    return jj, jj_1728;
end function;
